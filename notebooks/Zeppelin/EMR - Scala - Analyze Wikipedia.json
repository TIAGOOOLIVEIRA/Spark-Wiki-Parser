{"paragraphs":[{"text":"%md\n### Overview\nThis notebook will walk you through doing basic analysis with of the parsed Wikipedia data.  It assumes you have already parsed the Wikipedia dump and created your Parquet files.  If you have not done this then refer to the EMR-Scala-Process Wikipedia Dump notebook.\n\nThis notebook assumes you are hosting your files in S3.  Simply paste in your appropriate S3 info.  If you are having access denied errors then reference this page: [S3 EMR Permissions](http://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-iam-roles.html)\n\n###Configure the parser\nSee this page to add the correct dependencies to Zeppelin:\n[Wiki](https://github.com/nielsenbe/Spark-Wiki-Parser/wiki/EMR---Configure-Zeppelin)","dateUpdated":"2017-11-27T02:52:27+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Overview</h3>\n<p>This notebook will walk you through doing basic analysis with of the parsed Wikipedia data.  It assumes you have already parsed the Wikipedia dump and created your Parquet files.  If you have not done this then refer to the EMR-Scala-Process Wikipedia Dump notebook.</p>\n<p>This notebook assumes you are hosting your files in S3.  Simply paste in your appropriate S3 info.  If you are having access denied errors then reference this page: <a href=\"http://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-iam-roles.html\">S3 EMR Permissions</a></p>\n<h3>Configure the parser</h3>\n<p>See this page to add the correct dependencies to Zeppelin:\n<br  /><a href=\"https://github.com/nielsenbe/Spark-Wiki-Parser/wiki/EMR---Configure-Zeppelin\">Wiki</a></p>\n"}]},"apps":[],"jobName":"paragraph_1511751147137_-2128491345","id":"20171122-153844_1413776460","dateCreated":"2017-11-27T02:52:27+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:266"},{"text":"import main.scala.com.github.nielsenbe.sparkwikiparser.wikipedia._\n\n// Update S3 Info\nval bucketName = \"bnielsenemr\"\nval destFolder = \"wkpDb\"\n\n// Concat values\nval s3 = s\"s3://$bucketName/\"\nval destDB = s3 + destFolder + \"/\"","dateUpdated":"2017-11-27T02:59:41+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import main.scala.com.github.nielsenbe.sparkwikiparser.wikipedia._\nbucketName: String = bnielsenemr\ndestFolder: String = wkpDb\ns3: String = s3://bnielsenemr/\ndestDB: String = s3://bnielsenemr/wkpDb/\n"}]},"apps":[],"jobName":"paragraph_1511751147142_-2128876094","id":"20171122-154107_1675024326","dateCreated":"2017-11-27T02:52:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:267","user":"anonymous","dateFinished":"2017-11-27T03:00:32+0000","dateStarted":"2017-11-27T02:59:41+0000"},{"text":"// Load data\nspark.read.parquet(destDB + \"wkp_articles.parquet\").createOrReplaceTempView(\"articles\")\nspark.read.parquet(destDB + \"wkp_redirects.parquet\").createOrReplaceTempView(\"redirects\")\nspark.read.parquet(destDB + \"wkp_headers.parquet\").createOrReplaceTempView(\"headers\")\nspark.read.parquet(destDB + \"wkp_text.parquet\").createOrReplaceTempView(\"text\")\nspark.read.parquet(destDB + \"wkp_templates.parquet\").createOrReplaceTempView(\"templates\")\nspark.read.parquet(destDB + \"wkp_tags.parquet\").createOrReplaceTempView(\"tags\")\nspark.read.parquet(destDB + \"wkp_tables.parquet\").createOrReplaceTempView(\"tables\")","dateUpdated":"2017-11-27T03:03:38+0000","config":{"colWidth":12,"results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1511751147142_-2129260843","id":"20171122-154242_421197299","dateCreated":"2017-11-27T02:52:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:268","user":"anonymous","dateFinished":"2017-11-27T03:03:56+0000","dateStarted":"2017-11-27T03:03:38+0000"},{"text":"%md\n###Analyze articles\nWe'll start with doing some basic analysis on the articles.","dateUpdated":"2017-11-27T02:52:27+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Analyze articles</h3>\n<p>We'll start with doing some basic analysis on the articles.</p>\n"}]},"apps":[],"jobName":"paragraph_1511751147143_-2129260843","id":"20171122-154747_488039403","dateCreated":"2017-11-27T02:52:27+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:269"},{"text":"%spark.sql\n\nSELECT * \nFROM \n    articles\nLIMIT 25","dateUpdated":"2017-11-27T03:18:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\ttitle\tredirect\tnameSpace\tpageType\tlastRevisionId\tlastRevisionDate\n12\tAnarchism\t\tARTICLE\tARTICLE\t772891928\t1490831488\n25\tAutism\t\tARTICLE\tARTICLE\t773383617\t1491099593\n39\tAlbedo\t\tARTICLE\tARTICLE\t772364794\t1490563365\n290\tA\t\tARTICLE\tARTICLE\t767846522\t1488270326\n303\tAlabama\t\tARTICLE\tARTICLE\t773336636\t1491077951\n305\tAchilles\t\tARTICLE\tARTICLE\t773335098\t1491077219\n307\tAbraham Lincoln\t\tARTICLE\tARTICLE\t773371035\t1491093887\n308\tAristotle\t\tARTICLE\tARTICLE\t770119734\t1489417495\n309\tAn American in Paris\t\tARTICLE\tARTICLE\t768003556\t1488346246\n316\tAcademy Award for Best Production Design\t\tARTICLE\tARTICLE\t772452862\t1490612599\n324\tAcademy Awards\t\tARTICLE\tARTICLE\t773412867\t1491116677\n330\tActrius\t\tARTICLE\tARTICLE\t741600772\t1475073473\n332\tAnimalia (book)\t\tARTICLE\tARTICLE\t741600610\t1475073402\n334\tInternational Atomic Time\t\tARTICLE\tARTICLE\t764432308\t1486592135\n336\tAltruism\t\tARTICLE\tARTICLE\t772087487\t1490425478\n339\tAyn Rand\t\tARTICLE\tARTICLE\t771701398\t1490230716\n340\tAlain Connes\t\tARTICLE\tARTICLE\t769148130\t1488920844\n344\tAllan Dwan\t\tARTICLE\tARTICLE\t771278298\t1490028603\n358\tAlgeria\t\tARTICLE\tARTICLE\t773114008\t1490959457\n359\tList of Atlas Shrugged characters\t\tARTICLE\tLIST\t764431985\t1486592001\n569\tAnthropology\t\tARTICLE\tARTICLE\t772897940\t1490834838\n572\tAgricultural science\t\tARTICLE\tARTICLE\t771914941\t1490337994\n573\tAlchemy\t\tARTICLE\tARTICLE\t773279422\t1491052850\n579\tAlien\t\tARTICLE\tARTICLE\t766151547\t1487430192\n580\tAstronomer\t\tARTICLE\tARTICLE\t771926590\t1490346037\n586\tASCII\t\tARTICLE\tARTICLE\t772023150\t1490391058\n590\tAustin (disambiguation)\t\tARTICLE\tDISAMBIGUATION\t759100121\t1483942625\n593\tAnimation\t\tARTICLE\tARTICLE\t772581767\t1490673531\n594\tApollo\t\tARTICLE\tARTICLE\t773014038\t1490900758\n595\tAndre Agassi\t\tARTICLE\tARTICLE\t773352608\t1491085312\n597\tAustroasiatic languages\t\tARTICLE\tARTICLE\t764708418\t1486735012\n599\tAfroasiatic languages\t\tARTICLE\tARTICLE\t767473984\t1488081646\n600\tAndorra\t\tARTICLE\tARTICLE\t773168700\t1490987332\n612\tArithmetic mean\t\tARTICLE\tARTICLE\t771764942\t1490268799\n615\tAmerican Football Conference\t\tARTICLE\tARTICLE\t771884011\t1490320097\n620\tAnimal Farm\t\tARTICLE\tARTICLE\t771800677\t1490285315\n621\tAmphibian\t\tARTICLE\tARTICLE\t773373762\t1491095039\n624\tAlaska\t\tARTICLE\tARTICLE\t773305019\t1491064367\n627\tAgriculture\t\tARTICLE\tARTICLE\t773220117\t1491012986\n628\tAldous Huxley\t\tARTICLE\tARTICLE\t769474710\t1489089009\n630\tAda\t\tARTICLE\tARTICLE\t764630638\t1486687906\n632\tAberdeen (disambiguation)\t\tARTICLE\tDISAMBIGUATION\t769820792\t1489265530\n633\tAlgae\t\tARTICLE\tARTICLE\t772338669\t1490553012\n634\tAnalysis of variance\t\tARTICLE\tARTICLE\t773183477\t1490993589\n639\tAlkane\t\tARTICLE\tARTICLE\t772015060\t1490387732\n640\tAppellate procedure in the United States\t\tARTICLE\tARTICLE\t752431940\t1480571970\n642\tAnswer (law)\t\tARTICLE\tARTICLE\t768719057\t1488713176\n643\tAppellate court\t\tARTICLE\tARTICLE\t773253421\t1491035498\n649\tArraignment\t\tARTICLE\tARTICLE\t768431888\t1488569279\n651\tAmerica the Beautiful\t\tARTICLE\tARTICLE\t771193808\t1489979021\n653\tAssistive technology\t\tARTICLE\tARTICLE\t766614171\t1487652084\n655\tAbacus\t\tARTICLE\tARTICLE\t772770274\t1490770514\n656\tAcid\t\tARTICLE\tARTICLE\t772376719\t1490568191\n657\tAsphalt\t\tARTICLE\tARTICLE\t772535990\t1490649712\n659\tAmerican National Standards Institute\t\tARTICLE\tARTICLE\t772903153\t1490837564\n661\tArgument (disambiguation)\t\tARTICLE\tDISAMBIGUATION\t761372178\t1485103740\n662\tApollo 11\t\tARTICLE\tARTICLE\t767324458\t1488003714\n663\tApollo 8\t\tARTICLE\tARTICLE\t772858942\t1490815863\n664\tAstronaut\t\tARTICLE\tARTICLE\t771655863\t1490213075\n665\tA Modest Proposal\t\tARTICLE\tARTICLE\t763351615\t1486062522\n666\tAlkali metal\t\tARTICLE\tARTICLE\t771681554\t1490222967\n670\tAlphabet\t\tARTICLE\tARTICLE\t771472203\t1490122651\n673\tAtomic number\t\tARTICLE\tARTICLE\t770837182\t1489787644\n674\tAnatomy\t\tARTICLE\tARTICLE\t772772098\t1490771591\n675\tAffirming the consequent\t\tARTICLE\tARTICLE\t765755568\t1487230266\n676\tAndrei Tarkovsky\t\tARTICLE\tARTICLE\t773306382\t1491065006\n677\tAmbiguity\t\tARTICLE\tARTICLE\t772936728\t1490860044\n679\tAnimal (disambiguation)\t\tARTICLE\tDISAMBIGUATION\t767289427\t1487985168\n680\tAardvark\t\tARTICLE\tARTICLE\t772977832\t1490884878\n681\tAardwolf\t\tARTICLE\tARTICLE\t769123371\t1488911382\n682\tAdobe\t\tARTICLE\tARTICLE\t761976967\t1485385101\n683\tAdventure\t\tARTICLE\tARTICLE\t772907460\t1490839965\n689\tAsia\t\tARTICLE\tARTICLE\t772990744\t1490890430\n690\tAruba\t\tARTICLE\tARTICLE\t771029269\t1489891168\n691\tArticles of Confederation\t\tARTICLE\tARTICLE\t769456498\t1489081189\n694\tAsia Minor (disambiguation)\t\tARTICLE\tDISAMBIGUATION\t659166869\t1429981247\n698\tAtlantic Ocean\t\tARTICLE\tARTICLE\t772492667\t1490632167\n700\tArthur Schopenhauer\t\tARTICLE\tARTICLE\t773019124\t1490903156\n701\tAngola\t\tARTICLE\tARTICLE\t773200319\t1491001381\n704\tDemographics of Angola\t\tARTICLE\tARTICLE\t770918530\t1489839215\n705\tPolitics of Angola\t\tARTICLE\tARTICLE\t753412356\t1481071096\n706\tEconomy of Angola\t\tARTICLE\tARTICLE\t768897027\t1488801058\n708\tTransport in Angola\t\tARTICLE\tARTICLE\t770246942\t1489481272\n709\tAngolan Armed Forces\t\tARTICLE\tARTICLE\t766393809\t1487546783\n710\tForeign relations of Angola\t\tARTICLE\tARTICLE\t767178306\t1487934176\n711\tAlbert Sidney Johnston\t\tARTICLE\tARTICLE\t771298757\t1490037145\n713\tAndroid (robot)\t\tARTICLE\tARTICLE\t756921598\t1482860570\n717\tAlberta\t\tARTICLE\tARTICLE\t773347312\t1491082920\n728\tList of anthropologists\t\tARTICLE\tLIST\t771928100\t1490347067\n734\tActinopterygii\t\tARTICLE\tARTICLE\t773337725\t1491078479\n736\tAlbert Einstein\t\tARTICLE\tARTICLE\t772555413\t1490659140\n737\tAfghanistan\t\tARTICLE\tARTICLE\t773133383\t1490970827\n738\tAlbania\t\tARTICLE\tARTICLE\t773413888\t1491117482\n740\tAllah\t\tARTICLE\tARTICLE\t772688427\t1490728303\n742\tAlgorithms (journal)\t\tARTICLE\tARTICLE\t753239590\t1480983835\n746\tAzerbaijan\t\tARTICLE\tARTICLE\t773185615\t1490994574\n748\tAmateur astronomy\t\tARTICLE\tARTICLE\t767701760\t1488200982\n751\tAikido\t\tARTICLE\tARTICLE\t773416614\t1491119662\n752\tArt\t\tARTICLE\tARTICLE\t772210594\t1490484920\n764\tAgnostida\t\tARTICLE\tARTICLE\t770969032\t1489863499\n"}]},"apps":[],"jobName":"paragraph_1511751147143_-2129260843","id":"20171122-154501_1762393775","dateCreated":"2017-11-27T02:52:27+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:270"},{"text":"%spark.sql\n\nSELECT pageType, COUNT(*) AS articleCount FROM articles GROUP BY PageType ORDER BY articleCount DESC","dateUpdated":"2017-11-27T02:52:27+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"pageType\tarticleCount\nARTICLE\t14654\nDISAMBIGUATION\t255\nLIST\t147\nWIKIPEDIA\t92\nCATEGORY\t3\nPORTAL\t1\nHELP\t1\n"}]},"apps":[],"jobName":"paragraph_1511751147144_-2131184588","id":"20171122-154725_1322675620","dateCreated":"2017-11-27T02:52:27+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:271"},{"text":"%spark.sql\n\n-- Get articles with most redirects\nSELECT \n    art.id, \n    art.title,\n    rdr.redirectTitle,\n    COUNT(*) OVER (PARTITION BY art.id) AS totalRedirects\nFROM\n    articles art \nJOIN \n    redirects rdr \n    ON art.id = rdr.targetPageId\nORDER BY\n    totalRedirects DESC,\n    rdr.redirectTitle\nLIMIT 100","dateUpdated":"2017-11-27T03:18:37+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\ttitle\tredirectTitle\ttotalRedirects\n18866\tMacbeth\tMacbeth/Act I Scene i\t28\n18866\tMacbeth\tMacbeth/Act I Scene ii\t28\n18866\tMacbeth\tMacbeth/Act I Scene iii\t28\n18866\tMacbeth\tMacbeth/Act I Scene iv\t28\n18866\tMacbeth\tMacbeth/Act I Scene v\t28\n18866\tMacbeth\tMacbeth/Act I Scene vi\t28\n18866\tMacbeth\tMacbeth/Act I Scene vii\t28\n18866\tMacbeth\tMacbeth/Act II Scene i\t28\n18866\tMacbeth\tMacbeth/Act II Scene ii\t28\n18866\tMacbeth\tMacbeth/Act II Scene iii\t28\n18866\tMacbeth\tMacbeth/Act II Scene iv\t28\n18866\tMacbeth\tMacbeth/Act III Scene i\t28\n18866\tMacbeth\tMacbeth/Act III Scene ii\t28\n18866\tMacbeth\tMacbeth/Act III Scene iii\t28\n18866\tMacbeth\tMacbeth/Act III Scene iv\t28\n18866\tMacbeth\tMacbeth/Act III Scene v\t28\n18866\tMacbeth\tMacbeth/Act III Scene vi\t28\n18866\tMacbeth\tMacbeth/Act IV Scene i\t28\n18866\tMacbeth\tMacbeth/Act IV Scene ii\t28\n18866\tMacbeth\tMacbeth/Act IV Scene iii\t28\n18866\tMacbeth\tMacbeth/Act V Scene i\t28\n18866\tMacbeth\tMacbeth/Act V Scene ii\t28\n18866\tMacbeth\tMacbeth/Act V Scene iii\t28\n18866\tMacbeth\tMacbeth/Act V Scene iv\t28\n18866\tMacbeth\tMacbeth/Act V Scene v\t28\n18866\tMacbeth\tMacbeth/Act V Scene vi\t28\n18866\tMacbeth\tMacbeth/Act V Scene vii\t28\n18866\tMacbeth\tMacbeth/Act V Scene viii\t28\n9428\tErnest Hemingway\tErnest Hemingway/Bibliography\t22\n9428\tErnest Hemingway\tErnestHemingway\t22\n9428\tErnest Hemingway\tErnestHemingway/BibliographY\t22\n9428\tErnest Hemingway\tErnestHemingway/FamousatTwentyFiveThirtyaMaster\t22\n9428\tErnest Hemingway\tErnestHemingway/FromBoytoManHemingwaysFirstWorldWar\t22\n9428\tErnest Hemingway\tErnestHemingway/FromRealitytoFictionAFarewelltoArms\t22\n9428\tErnest Hemingway\tErnestHemingway/SureShotsTheSecondWorldWar\t22\n9428\tErnest Hemingway\tErnestHemingway/TheDownwardSpiral\t22\n9428\tErnest Hemingway\tErnestHemingway/TheEndlessDarkNothingness\t22\n9428\tErnest Hemingway\tErnestHemingway/TheTimeinBetween\t22\n9428\tErnest Hemingway\tErnestHemingway/ThingsTurnSour\t22\n9428\tErnest Hemingway\tErnestHemingway/ViolenceandRedemption\t22\n9428\tErnest Hemingway\tErnestHemingway/WhyItWentWrong\t22\n9428\tErnest Hemingway\tErnestHemingway/YoungandInnocent\t22\n9428\tErnest Hemingway\tFamous at Twenty-Five Thirty a Master\t22\n9428\tErnest Hemingway\tFrom Boy to Man Hemingways First World War\t22\n9428\tErnest Hemingway\tFrom Reality to Fiction A Farewell to Arms\t22\n9428\tErnest Hemingway\tSure Shots The Second World War\t22\n9428\tErnest Hemingway\tThe Endless Dark Nothingness\t22\n9428\tErnest Hemingway\tThings Turn Sour\t22\n9428\tErnest Hemingway\tViolence and Redemption\t22\n9428\tErnest Hemingway\tWhy It Went Wrong\t22\n29932\tOn the Origin of Species\tOrigin of Species\t19\n29932\tOn the Origin of Species\tPreface of Origin\t19\n29932\tOn the Origin of Species\tThe Origin of Species/Chapter 1\t19\n29932\tOn the Origin of Species\tThe Origin of Species/Chapter 10\t19\n29932\tOn the Origin of Species\tThe Origin of Species/Chapter 11\t19\n29932\tOn the Origin of Species\tThe Origin of Species/Chapter 12\t19\n29932\tOn the Origin of Species\tThe Origin of Species/Chapter 13\t19\n29932\tOn the Origin of Species\tThe Origin of Species/Chapter 14\t19\n29932\tOn the Origin of Species\tThe Origin of Species/Chapter 2\t19\n29932\tOn the Origin of Species\tThe Origin of Species/Chapter 3\t19\n29932\tOn the Origin of Species\tThe Origin of Species/Chapter 4\t19\n29932\tOn the Origin of Species\tThe Origin of Species/Chapter 5\t19\n29932\tOn the Origin of Species\tThe Origin of Species/Chapter 6\t19\n29932\tOn the Origin of Species\tThe Origin of Species/Chapter 7\t19\n29932\tOn the Origin of Species\tThe Origin of Species/Chapter 8\t19\n29932\tOn the Origin of Species\tThe Origin of Species/Chapter 9\t19\n29932\tOn the Origin of Species\tThe Origin of Species/Glossary\t19\n29932\tOn the Origin of Species\tThe Origin of Species/Introduction\t19\n29932\tOn the Origin of Species\tThe Origin of Species/Preface\t19\n13383\tHeard Island and McDonald Islands\tEconomy of Heard Island and McDonald Islands\t9\n27401\tSpratly Islands\tEconomy of the Spratly Islands\t9\n27401\tSpratly Islands\tGeography of the Spratly Islands\t9\n13383\tHeard Island and McDonald Islands\tHeard Island and McDonald Islands/Communications\t9\n13383\tHeard Island and McDonald Islands\tHeard Island and McDonald Islands/Geography\t9\n13383\tHeard Island and McDonald Islands\tHeard Island and McDonald Islands/Government\t9\n13383\tHeard Island and McDonald Islands\tHeard Island and McDonald Islands/History\t9\n13383\tHeard Island and McDonald Islands\tHeard Island and McDonald Islands/Military\t9\n13383\tHeard Island and McDonald Islands\tHeard Island and McDonald Islands/People\t9\n13383\tHeard Island and McDonald Islands\tHeard Island and McDonald Islands/Transnational issues\t9\n13383\tHeard Island and McDonald Islands\tHeard Island and McDonald Islands/Transportation\t9\n27401\tSpratly Islands\tHistory of the Spratly Islands\t9\n21312\tNavassa Island\tNavassa Island/Communications\t9\n21312\tNavassa Island\tNavassa Island/Economy\t9\n21312\tNavassa Island\tNavassa Island/Geography\t9\n21312\tNavassa Island\tNavassa Island/Government\t9\n21312\tNavassa Island\tNavassa Island/History\t9\n21312\tNavassa Island\tNavassa Island/Military\t9\n21312\tNavassa Island\tNavassa Island/People\t9\n21312\tNavassa Island\tNavassa Island/Transnational issues\t9\n21312\tNavassa Island\tNavassa Island/Transportation\t9\n27380\tSouth Georgia and the South Sandwich Islands\tSouth Georgia and the South Sandwich Islands/Communications\t9\n27380\tSouth Georgia and the South Sandwich Islands\tSouth Georgia and the South Sandwich Islands/Economy\t9\n27380\tSouth Georgia and the South Sandwich Islands\tSouth Georgia and the South Sandwich Islands/Geography\t9\n27380\tSouth Georgia and the South Sandwich Islands\tSouth Georgia and the South Sandwich Islands/Government\t9\n27380\tSouth Georgia and the South Sandwich Islands\tSouth Georgia and the South Sandwich Islands/History\t9\n27380\tSouth Georgia and the South Sandwich Islands\tSouth Georgia and the South Sandwich Islands/Military\t9\n27380\tSouth Georgia and the South Sandwich Islands\tSouth Georgia and the South Sandwich Islands/People\t9\n27380\tSouth Georgia and the South Sandwich Islands\tSouth Georgia and the South Sandwich Islands/Transnational issues\t9\n27380\tSouth Georgia and the South Sandwich Islands\tSouth Georgia and the South Sandwich Islands/Transportation\t9\n27401\tSpratly Islands\tSpratly Islands/Communications\t9\n"}]},"apps":[],"jobName":"paragraph_1511751147144_-2131184588","id":"20171122-155553_561072195","dateCreated":"2017-11-27T02:52:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:272","user":"anonymous","dateFinished":"2017-11-27T03:18:59+0000","dateStarted":"2017-11-27T03:18:37+0000"},{"text":"%md\n###Analyze Headers","dateUpdated":"2017-11-27T02:52:27+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Analyze Headers</h3>\n"}]},"apps":[],"jobName":"paragraph_1511751147155_-2121565865","id":"20171122-154937_538619075","dateCreated":"2017-11-27T02:52:27+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:273"},{"text":"%spark.sql\n\n-- Most common headers\nSELECT\n    title,\n    COUNT(*) AS headerCount\nFROM\n    headers\nGROUP BY\n    title\nORDER BY\n    headerCount DESC\nLIMIT 50","dateUpdated":"2017-11-27T02:52:27+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"title\theaderCount\nLEAD\t19859\nReferences\t12374\nExternal links\t11210\nSee also\t10589\nHistory\t4194\nFurther reading\t3726\nNotes\t3513\nBibliography\t1603\nEtymology\t861\nEarly life\t841\nSources\t732\nEducation\t655\nGeography\t648\nLegacy\t641\nClimate\t630\nEconomy\t584\nMusic\t578\nPersonal life\t534\nReligion\t525\nDemographics\t525\nBiography\t519\nCulture\t480\nUnited States\t458\nOther uses\t429\nDeath\t410\nIn popular culture\t409\nOverview\t402\nCareer\t402\nEvents\t388\nBackground\t379\nSports\t369\nFootnotes\t368\nApplications\t363\nDeaths\t362\nOther\t360\nExamples\t360\nBirths\t356\nHolidays and observances\t355\nCitations\t332\nGallery\t332\nMedia\t324\nTelevision\t319\nOrigins\t318\nWorks\t313\nTransport\t309\nPolitics\t308\nLife\t305\nLiterature\t303\nLanguages\t301\nReception\t277\n"}]},"apps":[],"jobName":"paragraph_1511751147157_-2123874358","id":"20171122-155020_714336951","dateCreated":"2017-11-27T02:52:27+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:274"},{"text":"%spark.sql\n\n-- Most common stub section (section that links back to main article via {{Main article}} template)\nSELECT\n    mainArticle,\n    COUNT(*) AS mainArticleCount\nFROM\n    headers\nWHERE\n    mainArticle IS NOT NULL\nGROUP BY\n    mainArticle\nORDER BY\n    mainArticleCount DESC\nLIMIT 10","dateUpdated":"2017-11-27T02:52:27+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"mainArticle\tmainArticleCount\nForeign relations of the Republic of Korea\t37\nForeign Legion Command\t8\n\t7\nForeign relations of South Korea\t6\nForeign relations of North Korea\t6\nAmerican Airlines Flight 77\t6\nAbbasid Caliphate\t5\nUtilitarianism\t5\nStandard Model\t5\nJewish principles of faith\t5\n"}]},"apps":[],"jobName":"paragraph_1511751147157_-2123874358","id":"20171122-161327_229625274","dateCreated":"2017-11-27T02:52:27+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:275"},{"text":"%md\n###Analyze Text","dateUpdated":"2017-11-27T02:52:27+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Analyze Text</h3>\n"}]},"apps":[],"jobName":"paragraph_1511751147157_-2123874358","id":"20171122-161512_1624169516","dateCreated":"2017-11-27T02:52:27+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:276"},{"text":"%spark.sql\n-- Longest articles\nSELECT\n    art.id,\n    art.title,\n    sub.textLength\nFROM\n    articles art\nJOIN (\n    SELECT\n        parentArticleId,\n        SUM(LENGTH(text)) AS textLength\n    FROM\n        text\n    GROUP BY\n        parentArticleId\n    ) SUB\n    ON  sub.parentArticleId = art.id\nORDER BY\n    textLength DESC\nLIMIT 50","dateUpdated":"2017-11-27T02:52:27+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\ttitle\ttextLength\n13224\tHistory of Germany\t172061\n13289\tHistory of the Netherlands\t172038\n13854\tHistory of France\t170343\n12157\tHistory of Guatemala\t169935\n14889\tIran–Iraq War\t169458\n14604\tForeign relations of India\t162594\n13971\tHistory of painting\t161870\n10186\tEastern Orthodox Church\t155652\n25401\tRomance languages\t152004\n13772\tHistory of Poland\t145560\n25507\tRoman Empire\t145274\n7023\tConfederate States of America\t144766\n13212\tHistory of Europe\t141118\n23435\tEconomy of Peru\t136019\n23041\tPuerto Rico\t131655\n13617\tHistory of Scotland\t130621\n21217\tNative Americans in the United States\t129828\n22936\tPoland\t126419\n26847\tSocialism\t126187\n13306\tHistory of Islam\t126171\n9516\tErwin Rommel\t126153\n19222\tHistory of Mexico\t125855\n11812\tLockheed Martin F-35 Lightning II\t125417\n14099\tHistory of Africa\t124944\n13808\tHistory of Israel\t124021\n18048\tLibertarian socialism\t123958\n23867\tPompey\t123778\n6787\tChiapas\t123423\n25391\tRussia\t121826\n23362\tHistory of Pakistan\t121785\n23033\tPortugal\t120662\n23235\tPakistan\t120574\n12108\tGreece\t120325\n26714\tSculpture\t118231\n17820\tHistory of Lithuania\t117193\n13890\tHistory of India\t116707\n23808\tPope Pius XII\t116376\n4675\tBritish Museum\t115150\n9288\tElvis Presley\t114396\n16547\tJoachim von Ribbentrop\t114094\n5416\tCapitalism\t114015\n26909\tSilvio Berlusconi\t113893\n8182\tDwight D. Eisenhower\t113465\n19728\tMarriage\t112718\n19603\tManhattan Project\t112547\n28678\tSabah\t112197\n23805\tPope John Paul II\t112112\n25074\tPersecution of Christians\t110757\n22989\tParis\t110713\n5224\tCitizen Kane\t109760\n"}]},"apps":[],"jobName":"paragraph_1511751147158_-2122720112","id":"20171122-161933_566706414","dateCreated":"2017-11-27T02:52:27+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:277"},{"text":"%md\n###Analyze Templates","dateUpdated":"2017-11-27T02:53:16+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Analyze Templates</h3>\n"}]},"apps":[],"jobName":"paragraph_1511751147158_-2122720112","id":"20171122-162413_1348679837","dateCreated":"2017-11-27T02:52:27+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:278"},{"text":"%spark.sql\n-- Get articles with most citation needed templates\nSELECT\n    art.id,\n    art.title,\n    COUNT(*) AS citationNeededCount\nFROM\n    articles art\nJOIN\n    templates tmp\n    ON tmp.parentArticleId = art.id\nWHERE\n    UPPER(tmp.templateType) = 'CITATION NEEDED'\nGROUP BY\n    art.id,\n    art.title\nORDER BY\n    citationNeededCount DESC\nLIMIT 25","dateUpdated":"2017-11-27T02:52:27+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\ttitle\tcitationNeededCount\n8035\tEconomy of Denmark\t215\n29974\tTotal war\t88\n23370\tForeign relations of Pakistan\t75\n12422\tList of gymnasts\t59\n19004\tMoscow\t51\n21433\tNew Testament\t50\n17514\tLatvia\t49\n16844\tKofi Annan\t47\n6715\tChris Marker\t47\n9424\tEricsson\t46\n6907\tChakra\t45\n14396\tHumvee\t45\n23056\tPope\t42\n27169\tSan Francisco 49ers\t41\n19137\tMalta\t40\n28502\tScuba set\t40\n2861\tAdvertising\t39\n14099\tHistory of Africa\t39\n21648\tNew Jersey\t39\n19292\tHistory of Morocco\t37\n22680\tOda Nobunaga\t37\n28267\tSydney Harbour Bridge\t37\n14863\tIncunable\t35\n13270\tHawaii\t32\n4477\tThe Beach Boys\t32\n"}]},"apps":[],"jobName":"paragraph_1511751147158_-2122720112","id":"20171122-162627_1352629522","dateCreated":"2017-11-27T02:52:27+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:279"},{"text":"%md\n###Analyze tags","dateUpdated":"2017-11-27T02:53:34+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","results":{},"enabled":true,"editorSetting":{"language":"markdown","editOnDblClick":true},"editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1511751147159_-2123104861","id":"20171122-162746_1013762568","dateCreated":"2017-11-27T02:52:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:280","user":"anonymous","dateFinished":"2017-11-27T02:53:35+0000","dateStarted":"2017-11-27T02:53:34+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Analyze tags</h3>\n"}]}},{"text":"%spark.sql\nSELECT\n    tag,\n    COUNT(*) AS mainArticleCount\nFROM\n    tags\nGROUP BY\n    tag\n","user":"anonymous","dateUpdated":"2017-11-27T03:05:22+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1511751214050_991711676","id":"20171127-025334_1265943978","dateCreated":"2017-11-27T02:53:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1703","dateFinished":"2017-11-27T03:05:38+0000","dateStarted":"2017-11-27T03:05:22+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"tag\tmainArticleCount\nnowiki\t1513\nmath\t28687\npre\t137\n"}]}},{"text":"%md\n###Analyze Tables","user":"anonymous","dateUpdated":"2017-11-27T03:09:26+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1511751287433_404324344","id":"20171127-025447_1341162256","dateCreated":"2017-11-27T02:54:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1792","dateFinished":"2017-11-27T03:09:26+0000","dateStarted":"2017-11-27T03:09:26+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Analyze Tables</h3>\n"}]}},{"text":"%spark.sql\n-- Get longest tables\nSELECT\n    art.id,\n    art.title,\n    tbl.caption,\n    LENGTH(html) AS tableLength\nFROM\n    articles art\nJOIN\n    tables tbl\n    ON tbl.parentArticleId = art.id\nORDER BY\n    tableLength DESC\nLIMIT 25","user":"anonymous","dateUpdated":"2017-11-27T03:11:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1511752166519_1283929849","id":"20171127-030926_1907597045","dateCreated":"2017-11-27T03:09:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2066","dateFinished":"2017-11-27T03:12:06+0000","dateStarted":"2017-11-27T03:11:51+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"id\ttitle\tcaption\ttableLength\n15910\tList of compositions by Johann Sebastian Bach\tWorks in Bach's catalogues and collections\t623473\n18886\tList of male singles tennis players\t\t167787\n17998\tList of Latin words with English derivatives\t\t149906\n10620\tList of female tennis players\t\t117491\n17998\tList of Latin words with English derivatives\t\t98539\n18196\tList of saints\t\t92990\n8615\tList of dog breeds\t\t92475\n2246\tAnalgesic\tComparison of different analgesics\t75323\n28942\tSolder\t\t70750\n26701\tList of current United States Senators\t\t66239\n15422\tList of Internet top-level domains\t\t64293\n21470\tList of national anthems\t\t60588\n8200\tTimeline of chemical element discoveries\t\t58483\n4391\tBig Brother (franchise)\t\t58468\n4016\tList of Byzantine emperors\t\t58340\n24205\tPrometheus Award\tList of winners and finalists for the Prometheus Award\t54509\n8968\tDevanagari\t\t54375\n9992\tList of contemporary ethnic groups\t\t52801\n27028\tForeign relations of South Korea\t\t52671\n7893\tDale Earnhardt\t\t47377\n18727\tInternational Numbering System for Food Additives\t\t46938\n15422\tList of Internet top-level domains\t\t45907\n11929\tDemographics of Germany\t\t44919\n19230\tForeign relations of Mexico\t\t43984\n14804\tList of Indian massacres\t\t43161\n"}]}},{"text":"%spark.sql\n","user":"anonymous","dateUpdated":"2017-11-27T03:11:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1511752289830_-1002881340","id":"20171127-031129_50297547","dateCreated":"2017-11-27T03:11:29+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2154"}],"name":"EMR - Scala - Analyze Wikipedia","id":"2D16HWEYQ","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}